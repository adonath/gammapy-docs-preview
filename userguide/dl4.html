
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Datasets (DL4) &#8212; gammapy v0.20.dev703+gba08bf709</title>
    
    <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
  
    
    <link rel="stylesheet"
      href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">
  
    
      
  
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/pydata-sphinx-theme.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gammapy.css" />
    
    <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">
  
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../_static/gammapy_logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Datasets - Reduced data, IRFs, models" href="../tutorials/api/datasets.html" />
    <link rel="prev" title="Ring background" href="../makers/ring.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/gammapy_logo_nav.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../getting-started/index.html">
  Getting started
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  User guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../tutorials/index.html">
  Tutorials
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../api.html">
  API reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../development/index.html">
  Development
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../changelog/index.html">
  Release notes
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <div class="dropdown" id="version_switcher">
    <button type="button" class="btn btn-primary btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        dev  <!-- this text may get changed later by javascript -->
        <span class="caret"></span>
    </button>
    <div id="version_switcher_menu" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
</div>

<!-- NOTE: this JS must live here (not in our global JS file) because it relies
     on being processed by Jinja before it is run (specifically for replacing
     variables userguide/dl4 and {'json_url': 'https://docs.gammapy.org/stable/switcher.json', 'url_template': 'https://docs.gammapy.org/{version}/', 'version_match': 'dev'}.
-->

<script type="text/javascript">
// Construct the target URL from the JSON components
function buildURL(entry) {
    var template = "https://docs.gammapy.org/{version}/";  // supplied by jinja
    template = template.replace("{version}", entry.version);
    return template;
}

// Check if corresponding page path exists in other version of docs
// and, if so, go there instead of the homepage of the other docs version
function checkPageExistsAndRedirect(event) {
    const currentFilePath = "userguide/dl4.html",
          tryUrl = event.target.getAttribute("href");
    let otherDocsHomepage = tryUrl.replace(currentFilePath, "");
    $.ajax({
        type: 'HEAD',
        url: tryUrl,
        // if the page exists, go there
        success: function() {
            location.href = tryUrl;
        }
    }).fail(function() {
        location.href = otherDocsHomepage;
    });
    // this prevents the browser from following the href of the clicked node
    // (which is fine because this function takes care of redirecting)
    return false;
}

// Populate the version switcher from the JSON config file
(function () {
    $.getJSON("https://docs.gammapy.org/stable/switcher.json", function(data, textStatus, jqXHR) {
        const currentFilePath = "userguide/dl4.html";
        // create links to the corresponding page in the other docs versions
        $.each(data, function(index, entry) {
            // if no custom name specified (e.g., "latest"), use version string
            if (!("name" in entry)) {
                entry.name = entry.version;
            }
            // create the node
            const node = document.createElement("a");
            node.setAttribute("class", "list-group-item list-group-item-action py-1");
            node.textContent = `${entry.name}`;
            // get the base URL for that doc version, add the current page's
            // path to it, and set as `href`
            entry.url = buildURL(entry);
            node.setAttribute("href", `${entry.url}${currentFilePath}`);
            // on click, AJAX calls will check if the linked page exists before
            // trying to redirect, and if not, will redirect to the homepage
            // for that version of the docs.
            node.onclick = checkPageExistsAndRedirect;
            $("#version_switcher_menu").append(node);
            // replace dropdown button text with the preferred display name of
            // this version, rather than using sphinx's 0.20.dev703+gba08bf709 variable.
            // also highlight the dropdown entry for the currently-viewed
            // version's entry
            if (entry.version == "dev") {
                node.classList.add("active");
                $("#version_switcher_button").text(entry.name);
            }
        });
    });
})();
</script>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/gammapy/gammapy" rel="noopener" target="_blank" title="Github"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">Github</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/gammapyST" rel="noopener" target="_blank" title="Twitter"><span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://gammapy.slack.com/" rel="noopener" target="_blank" title="Slack"><span><i class="fab fa-slack"></i></span>
            <label class="sr-only">Slack</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="analysis.html">
   Gamma-ray data analysis
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="package.html">
   Package structure
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="dl3.html">
     Data access and selection (DL3)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="makers.html">
     Data reduction (DL3 to DL4)
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Datasets (DL4)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="modeling.html">
     Modeling and Fitting (DL4 to DL5)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hli.html">
     High Level Analysis Interface
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="catalog.html">
     Source catalogs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="astro.html">
     Astrophysics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="stats.html">
     Statistical utility functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cli.html">
     Command line tools
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="visualization.html">
     Plotting features
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="utils.html">
     Utility functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../tutorials/index.html">
   Tutorials
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/starting/analysis_1.html">
     High level interface
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/starting/analysis_2.html">
     Low level API
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/starting/overview.html">
     Data structures
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/data/cta.html">
     CTA with Gammapy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/data/hess.html">
     H.E.S.S. with Gammapy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/data/fermi_lat.html">
     Fermi-LAT with Gammapy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/analysis/1D/spectral_analysis.html">
     Spectral analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/analysis/1D/spectral_analysis_rad_max.html">
     Spectral analysis with energy-dependent directional cuts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/analysis/1D/sed_fitting.html">
     Flux point fitting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/analysis/1D/extended_source_spectral_analysis.html">
     Spectral analysis of extended sources
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/analysis/1D/spectrum_simulation.html">
     1D spectrum simulation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/analysis/1D/cta_sensitivity.html">
     Point source sensitivity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/analysis/2D/ring_background.html">
     Ring background map
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/analysis/2D/modeling_2D.html">
     2D map fitting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/analysis/2D/detect.html">
     Source detection and significance maps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/analysis/3D/cta_data_analysis.html">
     Basic image exploration and fitting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/analysis/3D/analysis_3d.html">
     3D detailed analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/analysis/3D/simulate_3d.html">
     3D map simulation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/analysis/3D/analysis_mwl.html">
     Multi instrument joint 3D and 1D analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/analysis/3D/event_sampling.html">
     Event sampling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/analysis/3D/flux_profiles.html">
     Flux Profile Estimation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/analysis/time/light_curve_simulation.html">
     Simulating and fitting a time varying source
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/analysis/time/light_curve.html">
     Light curves
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/analysis/time/light_curve_flare.html">
     Light curves for flares
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/analysis/time/pulsar_analysis.html">
     Pulsar analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/api/makers.html">
     Makers - Data reduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/api/catalog.html">
     Source catalogs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/api/models.html">
     Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/api/model_management.html">
     Modelling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/api/fitting.html">
     Fitting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/api/maps.html">
     Maps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/api/mask_maps.html">
     Mask maps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/api/astro_dark_matter.html">
     Dark matter spatial and spectral models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/api/datasets.html">
     Datasets - Reduced data, IRFs, models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/survey_map.html">
     Survey map
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="howto.html">
   How To
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../modeling/gallery/index.html">
   Model gallery
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/spatial/plot_constant.html">
     Constant spatial model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/spatial/plot_disk.html">
     Disk spatial model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/spatial/plot_gauss.html">
     Gaussian spatial model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/spatial/plot_gen_gauss.html">
     Generalized gaussian spatial model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/spatial/plot_point.html">
     Point spatial model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/spatial/plot_shell.html">
     Shell spatial model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/spatial/plot_shell2.html">
     Shell2 spatial model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/spatial/plot_template.html">
     Template spatial model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/spectral/plot_absorbed.html">
     EBL absorbption spectral model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/spectral/plot_broken_powerlaw.html">
     Broken power law spectral model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/spectral/plot_compound.html">
     Compound spectral model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/spectral/plot_constant_spectral.html">
     Constant spectral model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/spectral/plot_exp_cutoff_powerlaw.html">
     Exponential cutoff power law spectral model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/spectral/plot_exp_cutoff_powerlaw_3fgl.html">
     Exponential cutoff power law spectral model used for 3FGL
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/spectral/plot_gauss_spectral.html">
     Gaussian spectral model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/spectral/plot_logparabola.html">
     Log parabola spectral model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/spectral/plot_naima.html">
     Naima spectral model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/spectral/plot_piecewise_norm_spectral.html">
     Piecewise  norm spectral model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/spectral/plot_powerlaw.html">
     Power law spectral model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/spectral/plot_powerlaw2.html">
     Power law 2 spectral model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/spectral/plot_smooth_broken_powerlaw.html">
     Smooth broken power law spectral model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/spectral/plot_super_exp_cutoff_powerlaw_3fgl.html">
     Super exponential cutoff power law model used for 3FGL
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/spectral/plot_super_exp_cutoff_powerlaw_4fgl.html">
     Super Exponential Cutoff Power Law Model used for 4FGL-DR3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/spectral/plot_super_exp_cutoff_powerlaw_4fgl_dr1.html">
     Super Exponential Cutoff Power Law Model used for 4FGL-DR1 (and DR2)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/spectral/plot_template_spectral.html">
     Template spectral model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/temporal/plot_constant_temporal.html">
     Constant temporal model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/temporal/plot_expdecay_temporal.html">
     ExpDecay temporal model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/temporal/plot_gaussian_temporal.html">
     Gaussian temporal model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/temporal/plot_generalized_gaussian_temporal.html">
     Generalized Gaussian temporal model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/temporal/plot_linear_temporal.html">
     Linear temporal model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/temporal/plot_powerlaw_temporal.html">
     PowerLaw temporal model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/temporal/plot_sine_temporal.html">
     Sine temporal model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling/gallery/temporal/plot_template_temporal.html">
     Light curve temporal model
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://gammapy.github.io/gammapy-recipes">
   Gammapy recipes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="references.html">
   Glossary and references
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   Datasets
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#types-of-supported-datasets">
     Types of supported datasets
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#predicted-counts">
     Predicted counts
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stacking-multiple-datasets">
     Stacking Multiple Datasets
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#joint-analysis">
     Joint Analysis
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-gammapy-datasets">
     Using gammapy.datasets
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sky-maps">
   Sky maps
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#getting-started-with-maps">
     Getting started with maps
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#differential-and-integral-maps">
     Differential and integral maps
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#accessor-methods">
     Accessor methods
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interface-with-mapcoord-and-skycoord">
     Interface with
     <code class="xref py py-obj docutils literal notranslate">
      <span class="pre">
       MapCoord
      </span>
     </code>
     and
     <code class="xref py py-obj docutils literal notranslate">
      <span class="pre">
       SkyCoord
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mapcoord">
     MapCoord
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-gammapy-maps">
     Using gammapy.maps
    </a>
    <ul class="nav section-nav flex-column">
    </ul>
   </li>
  </ul>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="datasets-dl4">
<span id="datasets"></span><h1>Datasets (DL4)<a class="headerlink" href="#datasets-dl4" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id1">
<h2>Datasets<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="../datasets/index.html#module-gammapy.datasets" title="gammapy.datasets"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.datasets</span></code></a> sub-package contains classes to handle reduced
gamma-ray data for modeling and fitting.</p>
<p>The <code class="xref py py-obj docutils literal notranslate"><span class="pre">Dataset</span></code> class bundles reduced data, IRFs and model to perform
likelihood fitting and joint-likelihood fitting.
All datasets contain a <a class="reference internal" href="../api/gammapy.modeling.models.Models.html#gammapy.modeling.models.Models" title="gammapy.modeling.models.Models"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Models</span></code></a> container with one or more
<a class="reference internal" href="../api/gammapy.modeling.models.SkyModel.html#gammapy.modeling.models.SkyModel" title="gammapy.modeling.models.SkyModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SkyModel</span></code></a> objects that represent additive emission
components.</p>
<p>To model and fit data in Gammapy, you have to create a
<a class="reference internal" href="../api/gammapy.datasets.Datasets.html#gammapy.datasets.Datasets" title="gammapy.datasets.Datasets"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Datasets</span></code></a> container object with one or multiple
<a class="reference internal" href="../api/gammapy.datasets.Dataset.html#gammapy.datasets.Dataset" title="gammapy.datasets.Dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Dataset</span></code></a> objects.</p>
<div class="section" id="types-of-supported-datasets">
<h3>Types of supported datasets<a class="headerlink" href="#types-of-supported-datasets" title="Permalink to this headline">¶</a></h3>
<p>Gammapy has built-in support to create and
analyse the following datasets:</p>
<table class="colwidths-given table">
<colgroup>
<col style="width: 8%" />
<col style="width: 15%" />
<col style="width: 38%" />
<col style="width: 15%" />
<col style="width: 15%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Dataset Type</strong></p></th>
<th class="head"><p><strong>Data Type</strong></p></th>
<th class="head"><p><strong>Reduced IRFs</strong></p></th>
<th class="head"><p><strong>Geometry</strong></p></th>
<th class="head"><p><strong>Additional Quantities</strong></p></th>
<th class="head"><p><strong>Fit Statistic</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="../api/gammapy.datasets.MapDataset.html#gammapy.datasets.MapDataset" title="gammapy.datasets.MapDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MapDataset</span></code></a></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">counts</span></code></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">background</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">psf</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">edisp</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">exposure</span></code>,</p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">WcsGeom</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">RegionGeom</span></code></p></td>
<td></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cash</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../api/gammapy.datasets.MapDatasetOnOff.html#gammapy.datasets.MapDatasetOnOff" title="gammapy.datasets.MapDatasetOnOff"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MapDatasetOnOff</span></code></a></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">counts</span></code></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">psf</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">edisp</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">exposure</span></code></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">WcsGeom</span></code></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">acceptance</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">acceptance_off</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">counts_off</span></code></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">wstat</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../api/gammapy.datasets.SpectrumDataset.html#gammapy.datasets.SpectrumDataset" title="gammapy.datasets.SpectrumDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SpectrumDataset</span></code></a></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">counts</span></code></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">background</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">edisp</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">exposure</span></code></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">RegionGeom</span></code></p></td>
<td></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cash</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../api/gammapy.datasets.SpectrumDatasetOnOff.html#gammapy.datasets.SpectrumDatasetOnOff" title="gammapy.datasets.SpectrumDatasetOnOff"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SpectrumDatasetOnOff</span></code></a></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">counts</span></code></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">edisp</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">exposure</span></code></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">RegionGeom</span></code></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">acceptance</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">acceptance_off</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">counts_off</span></code></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">wstat</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../api/gammapy.datasets.FluxPointsDataset.html#gammapy.datasets.FluxPointsDataset" title="gammapy.datasets.FluxPointsDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FluxPointsDataset</span></code></a></p></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">flux</span></code></p></td>
<td><p>None</p></td>
<td><p>None</p></td>
<td></td>
<td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">chi2</span></code></p></td>
</tr>
</tbody>
</table>
<p>In addition to the above quantities, a dataset can optionally have a
<code class="xref py py-obj docutils literal notranslate"><span class="pre">meta_table</span></code> serialised, which can contain relevant information about the observations
used to create the dataset.
In general, <code class="xref py py-obj docutils literal notranslate"><span class="pre">OnOff</span></code> datasets should be used when the
background is estimated from real off counts,
rather than from a background model.
The <a class="reference internal" href="../api/gammapy.datasets.FluxPointsDataset.html#gammapy.datasets.FluxPointsDataset" title="gammapy.datasets.FluxPointsDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FluxPointsDataset</span></code></a> is used to fit pre-computed flux points
when no convolution with IRFs are needed.</p>
<p>The map datasets represent 3D cubes (<a class="reference internal" href="../api/gammapy.maps.WcsNDMap.html#gammapy.maps.WcsNDMap" title="gammapy.maps.WcsNDMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WcsNDMap</span></code></a> objects) with two
spatial and one energy axis. For 2D images the same map objects and map datasets
are used, an energy axis is present but only has one energy bin.</p>
<p>The spectrum datasets represent 1D spectra (<a class="reference internal" href="../api/gammapy.maps.RegionNDMap.html#gammapy.maps.RegionNDMap" title="gammapy.maps.RegionNDMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RegionNDMap</span></code></a>
objects) with an energy axis. There are no spatial axes or information, the 1D
spectra are obtained for a given on region.</p>
<p>Note that in Gammapy, 2D image analyses are done with 3D cubes with a single
energy bin, e.g. for modeling and fitting.</p>
<p>To analyse multiple runs, you can either stack the datasets together, or perform
a joint fit across multiple datasets.</p>
</div>
<div class="section" id="predicted-counts">
<h3>Predicted counts<a class="headerlink" href="#predicted-counts" title="Permalink to this headline">¶</a></h3>
<p>The total number of predicted counts from a <code class="xref py py-obj docutils literal notranslate"><span class="pre">MapDataset</span></code> are computed per bin like:</p>
<div class="math notranslate nohighlight">
\[N_{Pred} = N_{Bkg} + \sum_{Src} N_{Src}\]</div>
<p>Where <span class="math notranslate nohighlight">\(N_{Bkg}\)</span> is the expected counts from the residual hadronic background
model and <span class="math notranslate nohighlight">\(N_{Src}\)</span> the predicted counts from a given source model component.
The predicted counts from the hadronic background are computed directly from
the model in reconstructed energy and spatial coordinates, while the predicted counts
from a source are obtained by forward folding with the instrument response:</p>
<div class="math notranslate nohighlight">
\[N_{Src} = \mathrm{PSF_{Src}} \circledast \mathrm{EDISP_{Src}}(\mathcal{E} \cdot F_{Src}(l, b, E_{True}))\]</div>
<p>Where <span class="math notranslate nohighlight">\(F_{Src}\)</span> is the integrated flux of the source model,
<span class="math notranslate nohighlight">\(\mathcal{E}\)</span> the exposure,
<span class="math notranslate nohighlight">\(\mathrm{EDISP}\)</span> the energy dispersion matrix and
<span class="math notranslate nohighlight">\(\mathrm{PSF}\)</span> the PSF convolution kernel. The corresponding IRFs are extracted
at the current position of the model component defined by <span class="math notranslate nohighlight">\((l, b)\)</span> and assumed
to be constant across the size of the source. The detailed expressions to compute the
predicted number of counts from a source and corresponding IRFs are given in <a class="reference internal" href="../irf/theory.html#irf-theory"><span class="std std-ref">IRF Theory</span></a>.</p>
</div>
<div class="section" id="stacking-multiple-datasets">
<span id="stack"></span><h3>Stacking Multiple Datasets<a class="headerlink" href="#stacking-multiple-datasets" title="Permalink to this headline">¶</a></h3>
<p>Stacking datasets implies that the counts, background and reduced IRFs from all the
runs are binned together to get one final dataset for which a likelihood is
computed during the fit. Stacking is often useful to reduce the computation effort while
analysing multiple runs.</p>
<p>The following table  lists how the individual quantities are handled during stacking.
Here, <span class="math notranslate nohighlight">\(k\)</span> denotes a bin in reconstructed energy,
<span class="math notranslate nohighlight">\(l\)</span> a bin in true energy and
<span class="math notranslate nohighlight">\(j\)</span> is the dataset number</p>
<table class="colwidths-given table">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Dataset attribute</p></th>
<th class="head"><p>Behaviour</p></th>
<th class="head"><p>Implementation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">livetime</span></code></p></td>
<td><p>Sum of individual livetimes</p></td>
<td><p><span class="math notranslate nohighlight">\(\overline{t} = \sum_j t_j\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">mask_safe</span></code></p></td>
<td><p>True if the pixel is included in the safe data range.</p></td>
<td><p><span class="math notranslate nohighlight">\(\overline{\epsilon_k} = \sum_{j} \epsilon_{jk}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">mask_fit</span></code></p></td>
<td><p>Dropped</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">counts</span></code></p></td>
<td><p>Summed in the data range defined by <code class="xref py py-obj docutils literal notranslate"><span class="pre">mask_safe</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(\overline{\mathrm{counts}_k} = \sum_j \mathrm{counts}_{jk} \cdot \epsilon_{jk}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">background</span></code></p></td>
<td><p>Summed in the data range defined by <code class="xref py py-obj docutils literal notranslate"><span class="pre">mask_safe</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(\overline{\mathrm{bkg}_k} = \sum_j \mathrm{bkg}_{jk} \cdot \epsilon_{jk}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exposure</span></code></p></td>
<td><p>Summed in the data range defined by <code class="xref py py-obj docutils literal notranslate"><span class="pre">mask_safe</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(\overline{\mathrm{exposure}_l} = \sum_{j} \mathrm{exposure}_{jl} \cdot \sum_k \epsilon_{jk}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">psf</span></code></p></td>
<td><p>Exposure weighted average</p></td>
<td><p><span class="math notranslate nohighlight">\(\overline{\mathrm{psf}_l} = \frac{\sum_{j} \mathrm{psf}_{jl} \cdot \mathrm{exposure}_{jl}} {\sum_{j} \mathrm{exposure}_{jl}}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">edisp</span></code></p></td>
<td><p>Exposure weighted average, with mask on reconstructed energy</p></td>
<td><p><span class="math notranslate nohighlight">\(\overline{\mathrm{edisp}_{kl}} = \frac{\sum_{j}\mathrm{edisp}_{jkl} \cdot \epsilon_{jk} \cdot \mathrm{exposure}_{jl}} {\sum_{j} \mathrm{exposure}_{jl}}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">gti</span></code></p></td>
<td><p>Union of individual <code class="xref py py-obj docutils literal notranslate"><span class="pre">gti</span></code></p></td>
<td></td>
</tr>
</tbody>
</table>
<p>For the model evaluation, an important factor that needs to be accounted for is
that the energy threshold changes between observations.
With the above implementation using a <code class="xref py py-obj docutils literal notranslate"><span class="pre">EDispersionMap</span></code>,
the <code class="xref py py-obj docutils literal notranslate"><span class="pre">npred</span></code> is conserved,
ie, the predicted number of counts on the stacked
dataset is the sum expected by stacking the <code class="xref py py-obj docutils literal notranslate"><span class="pre">npred</span></code> of the individual runs,</p>
<p>The following plot illustrates the stacked energy dispersion kernel and summed predicted counts for
individual as well as stacked spectral datasets:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>A stacked analysis is reasonable only when adding runs taken by the same instrument.</p></li>
<li><p>Stacking happens in-place, ie, <code class="docutils literal notranslate"><span class="pre">dataset1.stack(dataset2)</span></code> will overwrite <code class="docutils literal notranslate"><span class="pre">dataset1</span></code></p></li>
<li><p>To properly handle masks, it is necessary to stack onto an empty dataset.</p></li>
<li><p>Stacking only works for maps with equivalent geometry.
Two geometries are called equivalent if one is exactly the same as or can be obtained
from a cutout of the other.</p></li>
</ul>
</div>
</div>
<div class="section" id="joint-analysis">
<span id="joint"></span><h3>Joint Analysis<a class="headerlink" href="#joint-analysis" title="Permalink to this headline">¶</a></h3>
<p>An alternative to stacking datasets is a joint fit across all the datasets.
For a definition, see <a class="reference internal" href="references.html#glossary"><span class="std std-ref">Glossary</span></a>.</p>
<p>The total fit statistic of datasets is the sum of the
fit statistic of each dataset. Note that this is <strong>not</strong> equal to the
stacked fit statistic.</p>
<p>A joint fit usually allows a better modeling of the background because
the background model parameters can be fit for each dataset simultaneously
with the source models. However, a joint fit is, performance wise,
very computationally intensive.
The fit convergence time increases non-linearly with the number of datasets to be fit.
Moreover, depending upon the number of parameters in the background model,
even fit convergence might be an issue for a large number of datasets.</p>
<p>To strike a balance, what might be a practical solution for analysis of many runs is to
stack runs taken under similar conditions and then do a joint fit on the stacked datasets.</p>
</div>
<div class="section" id="using-gammapy-datasets">
<h3>Using gammapy.datasets<a class="headerlink" href="#using-gammapy-datasets" title="Permalink to this headline">¶</a></h3>
<p>Gammapy tutorial notebooks that show how to use this package:</p>
<div class="toctree-wrapper compound">
</div>
<div class="sphx-glr-thumbcontainer">
  <div class="figure align-center">
    <img alt="thumbnail" src="../_static/broken_example.png" />
    <p class="caption">
      <span class="caption-text">
        <a class="reference internal" href="../tutorials/api/datasets.html">
          <span class="std std-ref">Datasets - Reduced data, IRFs, models</span>
        </a>
      </span>
    </p>
  </div>
</div>
<div class="sphx-glr-thumbcontainer">
  <div class="figure align-center">
    <img alt="thumbnail" src="../_static/broken_example.png" />
    <p class="caption">
      <span class="caption-text">
        <a class="reference internal" href="../tutorials/api/model_management.html">
          <span class="std std-ref">Modelling</span>
        </a>
      </span>
    </p>
  </div>
</div>
<div class="sphx-glr-thumbcontainer">
  <div class="figure align-center">
    <img alt="thumbnail" src="../_static/broken_example.png" />
    <p class="caption">
      <span class="caption-text">
        <a class="reference internal" href="../tutorials/analysis/1D/sed_fitting.html">
          <span class="std std-ref">Flux point fitting</span>
        </a>
      </span>
    </p>
  </div>
</div>
<div class="sphx-glr-clear"></div></div>
</div>
<div class="section" id="sky-maps">
<span id="maps"></span><h2>Sky maps<a class="headerlink" href="#sky-maps" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="../maps/index.html#module-gammapy.maps" title="gammapy.maps"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.maps</span></code></a> contains classes for representing pixelized data structures with
at least two spatial dimensions representing coordinates on a sphere (e.g. an
image in celestial coordinates).  These classes support an arbitrary number of
non-spatial dimensions and can represent images (2D), cubes (3D), or hypercubes
(4+D).  Two pixelization schemes are supported:</p>
<ul class="simple">
<li><p>WCS : Projection onto a 2D cartesian grid following the conventions
of the World Coordinate System (WCS).  Pixels are square in projected
coordinates and as such are not equal area in spherical coordinates.</p></li>
<li><p>HEALPix : Hierarchical Equal Area Iso Latitude pixelation of the
sphere. Pixels are equal area but have irregular shapes.</p></li>
</ul>
<p><a class="reference internal" href="../maps/index.html#module-gammapy.maps" title="gammapy.maps"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.maps</span></code></a> is organized around two data structures: <em>geometry</em> classes
inheriting from <code class="xref py py-obj docutils literal notranslate"><span class="pre">Geom</span></code> and <em>map</em> classes inheriting from <code class="xref py py-obj docutils literal notranslate"><span class="pre">Map</span></code>. A geometry
defines the map boundaries, pixelization scheme, and provides methods for
converting to/from map and pixel coordinates. A map owns a <code class="xref py py-obj docutils literal notranslate"><span class="pre">Geom</span></code> instance
as well as a data array containing map values. Where possible it is recommended
to use the abstract <code class="xref py py-obj docutils literal notranslate"><span class="pre">Map</span></code> interface for accessing or updating the contents of a
map as this allows algorithms to be used interchangeably with different map
representations. The following reviews methods of the abstract map interface.
Documentation specific to WCS- and HEALPix-based maps is provided in <a class="reference internal" href="../maps/hpxmap.html"><span class="doc">HEALPix-based maps</span></a>.
Documentation specific to region-based maps is provided in <a class="reference internal" href="../maps/regionmap.html"><span class="doc">RegionGeom and RegionNDMap</span></a>.</p>
<div class="section" id="getting-started-with-maps">
<h3>Getting started with maps<a class="headerlink" href="#getting-started-with-maps" title="Permalink to this headline">¶</a></h3>
<p>All map objects have an abstract interface provided through the methods of the
<code class="xref py py-obj docutils literal notranslate"><span class="pre">Map</span></code>. These methods can be used for accessing and manipulating the contents of
a map without reference to the underlying data representation (e.g. whether a
map uses WCS or HEALPix pixelization). For applications which do depend on the
specific representation one can also work directly with the classes derived from
<code class="xref py py-obj docutils literal notranslate"><span class="pre">Map</span></code>. In the following we review some of the basic methods for working with
map objects, more details are given in the <a class="reference external" href="../tutorials/api/maps.html">maps tutorial</a>.</p>
</div>
<div class="section" id="differential-and-integral-maps">
<span id="node-types"></span><h3>Differential and integral maps<a class="headerlink" href="#differential-and-integral-maps" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../maps/index.html#module-gammapy.maps" title="gammapy.maps"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gammapy.maps</span></code></a> supports both differential and integral maps, representing
differential values at specific coordinates, or integral values within bins.
This is achieved by specifying the <code class="docutils literal notranslate"><span class="pre">node_type</span></code> of a <a class="reference internal" href="../api/gammapy.maps.MapAxis.html#gammapy.maps.MapAxis" title="gammapy.maps.MapAxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MapAxis</span></code></a>. Quantities
defined at bin centers should have a node_type of “center”, and quantities
integrated in bins should have node_type of <code class="docutils literal notranslate"><span class="pre">edges</span></code>. Interpolation is defined
only for differential quantities.</p>
<p>For the specific case of the energy axis, conventionally, true energies are have
node_type “center” (usually used for IRFs and exposure) whereas the
reconstructed energy axis has node_type “edges” (usually used for counts and
background). Model evaluations are first computed on differential bins, and then
multiplied by the bin volumes to finally return integrated maps, so the output
predicted counts maps are integral with node_type “edges”.</p>
</div>
<div class="section" id="accessor-methods">
<h3>Accessor methods<a class="headerlink" href="#accessor-methods" title="Permalink to this headline">¶</a></h3>
<p>All map objects have a set of accessor methods provided through the abstract
<code class="xref py py-obj docutils literal notranslate"><span class="pre">Map</span></code> class. These methods can be used to access or update the contents of the
map irrespective of its underlying representation. Four types of accessor
methods are provided:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">get</span></code> : Return the value of the map at the pixel containing the
given coordinate (<code class="xref py py-obj docutils literal notranslate"><span class="pre">get_by_idx</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">get_by_pix</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">get_by_coord</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">interp</span></code> : Interpolate or extrapolate the value of the map at an arbitrary
coordinate.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">set</span></code> : Set the value of the map at the pixel containing the
given coordinate (<code class="xref py py-obj docutils literal notranslate"><span class="pre">set_by_idx</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">set_by_pix</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">set_by_coord</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fill</span></code> : Increment the value of the map at the pixel containing
the given coordinate with a unit weight or the value in the optional
<code class="docutils literal notranslate"><span class="pre">weights</span></code> argument (<code class="xref py py-obj docutils literal notranslate"><span class="pre">fill_by_idx</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">fill_by_pix</span></code>,
<code class="xref py py-obj docutils literal notranslate"><span class="pre">fill_by_coord</span></code>).</p></li>
</ul>
<p>Accessor methods accept as their first argument a coordinate tuple containing
scalars, lists, or numpy arrays with one tuple element for each dimension of the
map. <code class="docutils literal notranslate"><span class="pre">coord</span></code> methods optionally support a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">MapCoord</span></code> argument.</p>
<p>When using tuple input the first two elements in the tuple should be longitude
and latitude followed by one element for each non-spatial dimension. Map
coordinates can be expressed in one of three coordinate systems:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">idx</span></code> : Pixel indices.  These are explicit (integer) pixel indices into the
map.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pix</span></code> : Coordinates in pixel space.  Pixel coordinates are continuous defined
on the interval [0,N-1] where N is the number of pixels along a given map
dimension with pixel centers at integer values.  For methods that reference a
discrete pixel, pixel coordinates will be rounded to the nearest pixel index
and passed to the corresponding <code class="docutils literal notranslate"><span class="pre">idx</span></code> method.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coord</span></code> : The true map coordinates including angles on the sky (longitude
and latitude).  This coordinate system supports three coordinate
representations: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>, and <code class="xref py py-obj docutils literal notranslate"><span class="pre">MapCoord</span></code>.  The tuple representation
should contain longitude and latitude in degrees followed by one coordinate
array for each non-spatial dimension.</p></li>
</ul>
<p>The coordinate system accepted by a given accessor method can be inferred from
the suffix of the method name (e.g. <code class="xref py py-obj docutils literal notranslate"><span class="pre">get_by_idx</span></code>).  The following
demonstrates how one can access the same pixels of a WCS map using each of the
three coordinate systems:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gammapy.maps</span> <span class="kn">import</span> <span class="n">Map</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">Map</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">binsz</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">map_type</span><span class="o">=</span><span class="s1">&#39;wcs&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>

<span class="n">vals</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">get_by_idx</span><span class="p">(</span> <span class="p">([</span><span class="mi">49</span><span class="p">,</span><span class="mi">50</span><span class="p">],[</span><span class="mi">49</span><span class="p">,</span><span class="mi">50</span><span class="p">])</span> <span class="p">)</span>
<span class="n">vals</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">get_by_pix</span><span class="p">(</span> <span class="p">([</span><span class="mf">49.0</span><span class="p">,</span><span class="mf">50.0</span><span class="p">],[</span><span class="mf">49.0</span><span class="p">,</span><span class="mf">50.0</span><span class="p">])</span> <span class="p">)</span>
<span class="n">vals</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">get_by_coord</span><span class="p">(</span> <span class="p">([</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span><span class="o">-</span><span class="mf">0.05</span><span class="p">],[</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.05</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
<p>Coordinate arguments obey normal numpy broadcasting rules.  The coordinate tuple
may contain any combination of scalars, lists or numpy arrays as long as they
have compatible shapes.  For instance a combination of scalar and vector
arguments can be used to perform an operation along a slice of the map at a
fixed value along that dimension. Multi-dimensional arguments can be use to
broadcast a given operation across a grid of coordinate values.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">gammapy.maps</span> <span class="kn">import</span> <span class="n">Map</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">Map</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">binsz</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">map_type</span><span class="o">=</span><span class="s1">&#39;wcs&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
<span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>

<span class="c1"># Equivalent calls for accessing value at pixel (49,49)</span>
<span class="n">vals</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">get_by_idx</span><span class="p">(</span> <span class="p">(</span><span class="mi">49</span><span class="p">,</span><span class="mi">49</span><span class="p">)</span> <span class="p">)</span>
<span class="n">vals</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">get_by_idx</span><span class="p">(</span> <span class="p">([</span><span class="mi">49</span><span class="p">],[</span><span class="mi">49</span><span class="p">])</span> <span class="p">)</span>
<span class="n">vals</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">get_by_idx</span><span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">49</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">49</span><span class="p">]))</span> <span class="p">)</span>

<span class="c1"># Retrieve map values along latitude at fixed longitude=0.0</span>
<span class="n">vals</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">get_by_coord</span><span class="p">(</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">coords</span><span class="p">)</span> <span class="p">)</span>
<span class="c1"># Retrieve map values on a 2D grid of latitude/longitude points</span>
<span class="n">vals</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">get_by_coord</span><span class="p">(</span> <span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="kc">None</span><span class="p">,:],</span> <span class="n">coords</span><span class="p">[:,</span><span class="kc">None</span><span class="p">])</span> <span class="p">)</span>
<span class="c1"># Set map values along slice at longitude=0.0 to twice their existing value</span>
<span class="n">m</span><span class="o">.</span><span class="n">set_by_coord</span><span class="p">((</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">coords</span><span class="p">),</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">m</span><span class="o">.</span><span class="n">get_by_coord</span><span class="p">((</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">coords</span><span class="p">)))</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">set</span></code> and <code class="docutils literal notranslate"><span class="pre">fill</span></code> methods can both be used to set pixel values. The
following demonstrates how one can set pixel values:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gammapy.maps</span> <span class="kn">import</span> <span class="n">Map</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">Map</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">binsz</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">map_type</span><span class="o">=</span><span class="s1">&#39;wcs&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>

<span class="n">m</span><span class="o">.</span><span class="n">set_by_coord</span><span class="p">(([</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">]),</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
<span class="n">m</span><span class="o">.</span><span class="n">fill_by_coord</span><span class="p">(</span> <span class="p">([</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">]),</span> <span class="n">weights</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="section" id="interface-with-mapcoord-and-skycoord">
<h3>Interface with <code class="xref py py-obj docutils literal notranslate"><span class="pre">MapCoord</span></code> and <a class="reference external" href="https://docs.astropy.org/en/latest/api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord" title="(in Astropy v5.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SkyCoord</span></code></a><a class="headerlink" href="#interface-with-mapcoord-and-skycoord" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">coord</span></code> accessor methods accept <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">MapCoord</span></code>, and
<a class="reference external" href="https://docs.astropy.org/en/latest/api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord" title="(in Astropy v5.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SkyCoord</span></code></a> arguments in addition to the standard <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code></a> argument.  When using a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> argument a
<a class="reference external" href="https://docs.astropy.org/en/latest/api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord" title="(in Astropy v5.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SkyCoord</span></code></a> can be used instead of longitude and latitude
arrays.  The coordinate frame of the <a class="reference external" href="https://docs.astropy.org/en/latest/api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord" title="(in Astropy v5.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SkyCoord</span></code></a> will be
transformed to match the coordinate system of the map.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">SkyCoord</span>
<span class="kn">from</span> <span class="nn">gammapy.maps</span> <span class="kn">import</span> <span class="n">Map</span><span class="p">,</span> <span class="n">MapCoord</span><span class="p">,</span> <span class="n">MapAxis</span>

<span class="n">lon</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">lat</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">energy</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>
<span class="n">energy_axis</span> <span class="o">=</span> <span class="n">MapAxis</span><span class="o">.</span><span class="n">from_bounds</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mf">1E5</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">interp</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;energy&#39;</span><span class="p">)</span>

<span class="n">skycoord</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s1">&#39;galactic&#39;</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">Map</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">binsz</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">map_type</span><span class="o">=</span><span class="s1">&#39;wcs&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
              <span class="n">frame</span><span class="o">=</span><span class="s2">&quot;galactic&quot;</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">energy_axis</span><span class="p">])</span>

<span class="n">m</span><span class="o">.</span><span class="n">set_by_coord</span><span class="p">((</span><span class="n">skycoord</span><span class="p">,</span> <span class="n">energy</span><span class="p">),</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
<span class="n">m</span><span class="o">.</span><span class="n">get_by_coord</span><span class="p">((</span><span class="n">skycoord</span><span class="p">,</span> <span class="n">energy</span><span class="p">))</span>
</pre></div>
</div>
<p>A <code class="xref py py-obj docutils literal notranslate"><span class="pre">MapCoord</span></code> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a> argument can be used to interact with a map object
without reference to the axis ordering of the map geometry:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">coord</span> <span class="o">=</span> <span class="n">MapCoord</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span> <span class="n">energy</span><span class="o">=</span><span class="n">energy</span><span class="p">))</span>
<span class="n">m</span><span class="o">.</span><span class="n">set_by_coord</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
<span class="n">m</span><span class="o">.</span><span class="n">get_by_coord</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">set_by_coord</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span> <span class="n">energy</span><span class="o">=</span><span class="n">energy</span><span class="p">),</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
<span class="n">m</span><span class="o">.</span><span class="n">get_by_coord</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span> <span class="n">energy</span><span class="o">=</span><span class="n">energy</span><span class="p">))</span>
</pre></div>
</div>
<p>However when using the named axis interface the axis name string (e.g. as given
by <code class="xref py py-obj docutils literal notranslate"><span class="pre">MapAxis.name</span></code>) must match the name given in the method argument.  The two
spatial axes must always be named <code class="docutils literal notranslate"><span class="pre">lon</span></code> and <code class="docutils literal notranslate"><span class="pre">lat</span></code>.</p>
</div>
<div class="section" id="mapcoord">
<span id="id2"></span><h3>MapCoord<a class="headerlink" href="#mapcoord" title="Permalink to this headline">¶</a></h3>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">MapCoord</span></code> is an N-dimensional coordinate object that stores both spatial and
non-spatial coordinates and is accepted by all <code class="docutils literal notranslate"><span class="pre">coord</span></code> methods. A <code class="xref py py-obj docutils literal notranslate"><span class="pre">MapCoord</span></code>
can be created with or without explicitly named axes with <code class="xref py py-obj docutils literal notranslate"><span class="pre">MapCoord.create</span></code>.
Axes of a <code class="xref py py-obj docutils literal notranslate"><span class="pre">MapCoord</span></code> can be accessed by index, name, or attribute.  A <code class="xref py py-obj docutils literal notranslate"><span class="pre">MapCoord</span></code>
without explicit axis names can be created by calling <code class="xref py py-obj docutils literal notranslate"><span class="pre">MapCoord.create</span></code> with a
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> argument:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">SkyCoord</span>
<span class="kn">from</span> <span class="nn">gammapy.maps</span> <span class="kn">import</span> <span class="n">MapCoord</span>

<span class="n">lon</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="n">lat</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]</span>
<span class="n">energy</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>
<span class="n">skycoord</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s1">&#39;galactic&#39;</span><span class="p">)</span>

<span class="c1"># Create a MapCoord from a tuple (no explicit axis names)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">MapCoord</span><span class="o">.</span><span class="n">create</span><span class="p">((</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">energy</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">.</span><span class="n">lon</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">.</span><span class="n">lat</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;axis0&#39;</span><span class="p">])</span>

<span class="c1"># Create a MapCoord from a tuple + SkyCoord (no explicit axis names)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">MapCoord</span><span class="o">.</span><span class="n">create</span><span class="p">((</span><span class="n">skycoord</span><span class="p">,</span> <span class="n">energy</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">.</span><span class="n">lon</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">.</span><span class="n">lat</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;axis0&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>The first two elements of the tuple argument must contain longitude and
latitude.  Non-spatial axes are assigned a default name <code class="docutils literal notranslate"><span class="pre">axis{I}</span></code> where
<code class="docutils literal notranslate"><span class="pre">{I}</span></code> is the index of the non-spatial dimension. <code class="xref py py-obj docutils literal notranslate"><span class="pre">MapCoord</span></code> objects created
without named axes must have the same axis ordering as the map geometry.</p>
<p>A <code class="xref py py-obj docutils literal notranslate"><span class="pre">MapCoord</span></code> with named axes can be created by calling <code class="xref py py-obj docutils literal notranslate"><span class="pre">MapCoord.create</span></code> with a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">MapCoord</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span> <span class="n">energy</span><span class="o">=</span><span class="n">energy</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">.</span><span class="n">lon</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">.</span><span class="n">lat</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">])</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">MapCoord</span><span class="o">.</span><span class="n">create</span><span class="p">({</span><span class="s1">&#39;energy&#39;</span><span class="p">:</span> <span class="n">energy</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">:</span> <span class="n">lon</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="n">lat</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">.</span><span class="n">lon</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">.</span><span class="n">lat</span><span class="p">)</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">MapCoord</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">skycoord</span><span class="o">=</span><span class="n">skycoord</span><span class="p">,</span> <span class="n">energy</span><span class="o">=</span><span class="n">energy</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">.</span><span class="n">lon</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">.</span><span class="n">lat</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Spatial axes must be named <code class="docutils literal notranslate"><span class="pre">lon</span></code> and <code class="docutils literal notranslate"><span class="pre">lat</span></code>. <code class="xref py py-obj docutils literal notranslate"><span class="pre">MapCoord</span></code> objects created with
named axes do not need to have the same axis ordering as the map geometry.
However the name of the axis must match the name of the corresponding map
geometry axis.</p>
</div>
<div class="section" id="using-gammapy-maps">
<h3>Using gammapy.maps<a class="headerlink" href="#using-gammapy-maps" title="Permalink to this headline">¶</a></h3>
<p>Gammapy tutorial notebooks that show examples using <code class="docutils literal notranslate"><span class="pre">gammapy.maps</span></code>:</p>
<div class="toctree-wrapper compound">
</div>
<div class="sphx-glr-thumbcontainer">
  <div class="figure align-center">
    <img alt="thumbnail" src="../_static/broken_example.png" />
    <p class="caption">
      <span class="caption-text">
        <a class="reference internal" href="../tutorials/api/maps.html">
          <span class="std std-ref">Maps</span>
        </a>
      </span>
    </p>
  </div>
</div>
<div class="sphx-glr-thumbcontainer">
  <div class="figure align-center">
    <img alt="thumbnail" src="../_static/broken_example.png" />
    <p class="caption">
      <span class="caption-text">
        <a class="reference internal" href="../tutorials/analysis/3D/analysis_3d.html">
          <span class="std std-ref">3D detailed analysis</span>
        </a>
      </span>
    </p>
  </div>
</div>
<div class="sphx-glr-thumbcontainer">
  <div class="figure align-center">
    <img alt="thumbnail" src="../_static/broken_example.png" />
    <p class="caption">
      <span class="caption-text">
        <a class="reference internal" href="../tutorials/analysis/3D/simulate_3d.html">
          <span class="std std-ref">3D map simulation</span>
        </a>
      </span>
    </p>
  </div>
</div>
<div class="sphx-glr-thumbcontainer">
  <div class="figure align-center">
    <img alt="thumbnail" src="../_static/broken_example.png" />
    <p class="caption">
      <span class="caption-text">
        <a class="reference internal" href="../tutorials/data/fermi_lat.html">
          <span class="std std-ref">Fermi-LAT with Gammapy</span>
        </a>
      </span>
    </p>
  </div>
</div>
<div class="sphx-glr-clear"></div><p>More detailed documentation on the WCS and HPX classes in <code class="docutils literal notranslate"><span class="pre">gammapy.maps</span></code> can be
found in the following sub-pages:</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../maps/hpxmap.html">HEALPix-based maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maps/regionmap.html">RegionGeom and RegionNDMap</a></li>
</ul>
</div>
</div>
</div>
</div>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../makers/ring.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Ring background</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../tutorials/api/datasets.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Datasets - Reduced data, IRFs, models</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
    <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022, The Gammapy developers.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.4.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>